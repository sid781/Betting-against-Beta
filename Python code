{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "x=pd.read_excel('Returns.xlsx')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>RELIANCE.NS</th>\n",
       "      <th>TCS.NS</th>\n",
       "      <th>HINDUNILVR.NS</th>\n",
       "      <th>HDFCBANK.NS</th>\n",
       "      <th>HDFC.NS</th>\n",
       "      <th>INFY.NS</th>\n",
       "      <th>KOTAKBANK.NS</th>\n",
       "      <th>BHARTIARTL.NS</th>\n",
       "      <th>ITC.NS</th>\n",
       "      <th>...</th>\n",
       "      <th>HONAUT.NS</th>\n",
       "      <th>TATAMOTORS.NS</th>\n",
       "      <th>PNB.NS</th>\n",
       "      <th>HINDALCO.NS</th>\n",
       "      <th>GLAXO.NS</th>\n",
       "      <th>3MINDIA.NS</th>\n",
       "      <th>PEL.NS</th>\n",
       "      <th>KANSAINER.NS</th>\n",
       "      <th>ADANITRANS.NS</th>\n",
       "      <th>NIFTY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2018-10-22</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-10-23</td>\n",
       "      <td>0.992519</td>\n",
       "      <td>0.970853</td>\n",
       "      <td>0.979273</td>\n",
       "      <td>0.992971</td>\n",
       "      <td>1.017156</td>\n",
       "      <td>0.967130</td>\n",
       "      <td>1.008978</td>\n",
       "      <td>1.000526</td>\n",
       "      <td>0.991335</td>\n",
       "      <td>...</td>\n",
       "      <td>0.972738</td>\n",
       "      <td>0.999414</td>\n",
       "      <td>0.985540</td>\n",
       "      <td>0.979911</td>\n",
       "      <td>0.973503</td>\n",
       "      <td>0.928361</td>\n",
       "      <td>1.014178</td>\n",
       "      <td>0.937670</td>\n",
       "      <td>1.003783</td>\n",
       "      <td>0.990391</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-10-24</td>\n",
       "      <td>0.991514</td>\n",
       "      <td>1.002631</td>\n",
       "      <td>1.021842</td>\n",
       "      <td>1.003728</td>\n",
       "      <td>1.032429</td>\n",
       "      <td>0.988139</td>\n",
       "      <td>1.002256</td>\n",
       "      <td>1.104759</td>\n",
       "      <td>1.006119</td>\n",
       "      <td>...</td>\n",
       "      <td>1.002461</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.016216</td>\n",
       "      <td>1.047153</td>\n",
       "      <td>0.972006</td>\n",
       "      <td>1.026624</td>\n",
       "      <td>1.013196</td>\n",
       "      <td>1.003310</td>\n",
       "      <td>1.003769</td>\n",
       "      <td>1.007682</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-10-25</td>\n",
       "      <td>0.985704</td>\n",
       "      <td>1.002434</td>\n",
       "      <td>0.996576</td>\n",
       "      <td>0.988229</td>\n",
       "      <td>0.973011</td>\n",
       "      <td>1.009256</td>\n",
       "      <td>1.007391</td>\n",
       "      <td>0.935729</td>\n",
       "      <td>0.999305</td>\n",
       "      <td>...</td>\n",
       "      <td>1.008292</td>\n",
       "      <td>0.968942</td>\n",
       "      <td>0.997720</td>\n",
       "      <td>0.967370</td>\n",
       "      <td>0.974509</td>\n",
       "      <td>0.987805</td>\n",
       "      <td>0.964029</td>\n",
       "      <td>1.010859</td>\n",
       "      <td>0.974969</td>\n",
       "      <td>0.990235</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-10-26</td>\n",
       "      <td>1.013679</td>\n",
       "      <td>0.970912</td>\n",
       "      <td>0.991537</td>\n",
       "      <td>0.996140</td>\n",
       "      <td>1.004515</td>\n",
       "      <td>0.976647</td>\n",
       "      <td>0.977062</td>\n",
       "      <td>1.008118</td>\n",
       "      <td>0.976874</td>\n",
       "      <td>...</td>\n",
       "      <td>1.007621</td>\n",
       "      <td>1.019050</td>\n",
       "      <td>1.007616</td>\n",
       "      <td>0.995053</td>\n",
       "      <td>1.006012</td>\n",
       "      <td>0.985242</td>\n",
       "      <td>1.031656</td>\n",
       "      <td>0.995649</td>\n",
       "      <td>0.999037</td>\n",
       "      <td>0.990627</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 102 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Date  RELIANCE.NS    TCS.NS  HINDUNILVR.NS  HDFCBANK.NS   HDFC.NS  \\\n",
       "0 2018-10-22          NaN       NaN            NaN          NaN       NaN   \n",
       "1 2018-10-23     0.992519  0.970853       0.979273     0.992971  1.017156   \n",
       "2 2018-10-24     0.991514  1.002631       1.021842     1.003728  1.032429   \n",
       "3 2018-10-25     0.985704  1.002434       0.996576     0.988229  0.973011   \n",
       "4 2018-10-26     1.013679  0.970912       0.991537     0.996140  1.004515   \n",
       "\n",
       "    INFY.NS  KOTAKBANK.NS  BHARTIARTL.NS    ITC.NS  ...  HONAUT.NS  \\\n",
       "0       NaN           NaN            NaN       NaN  ...        NaN   \n",
       "1  0.967130      1.008978       1.000526  0.991335  ...   0.972738   \n",
       "2  0.988139      1.002256       1.104759  1.006119  ...   1.002461   \n",
       "3  1.009256      1.007391       0.935729  0.999305  ...   1.008292   \n",
       "4  0.976647      0.977062       1.008118  0.976874  ...   1.007621   \n",
       "\n",
       "   TATAMOTORS.NS    PNB.NS  HINDALCO.NS  GLAXO.NS  3MINDIA.NS    PEL.NS  \\\n",
       "0            NaN       NaN          NaN       NaN         NaN       NaN   \n",
       "1       0.999414  0.985540     0.979911  0.973503    0.928361  1.014178   \n",
       "2       1.000000  1.016216     1.047153  0.972006    1.026624  1.013196   \n",
       "3       0.968942  0.997720     0.967370  0.974509    0.987805  0.964029   \n",
       "4       1.019050  1.007616     0.995053  1.006012    0.985242  1.031656   \n",
       "\n",
       "   KANSAINER.NS  ADANITRANS.NS     NIFTY  \n",
       "0           NaN            NaN       NaN  \n",
       "1      0.937670       1.003783  0.990391  \n",
       "2      1.003310       1.003769  1.007682  \n",
       "3      1.010859       0.974969  0.990235  \n",
       "4      0.995649       0.999037  0.990627  \n",
       "\n",
       "[5 rows x 102 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "x=x.drop(\"SBICARD.NS\",axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "x=x.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>RELIANCE.NS</th>\n",
       "      <th>TCS.NS</th>\n",
       "      <th>HINDUNILVR.NS</th>\n",
       "      <th>HDFCBANK.NS</th>\n",
       "      <th>HDFC.NS</th>\n",
       "      <th>INFY.NS</th>\n",
       "      <th>KOTAKBANK.NS</th>\n",
       "      <th>BHARTIARTL.NS</th>\n",
       "      <th>ITC.NS</th>\n",
       "      <th>...</th>\n",
       "      <th>HONAUT.NS</th>\n",
       "      <th>TATAMOTORS.NS</th>\n",
       "      <th>PNB.NS</th>\n",
       "      <th>HINDALCO.NS</th>\n",
       "      <th>GLAXO.NS</th>\n",
       "      <th>3MINDIA.NS</th>\n",
       "      <th>PEL.NS</th>\n",
       "      <th>KANSAINER.NS</th>\n",
       "      <th>ADANITRANS.NS</th>\n",
       "      <th>NIFTY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2018-10-23</td>\n",
       "      <td>0.992519</td>\n",
       "      <td>0.970853</td>\n",
       "      <td>0.979273</td>\n",
       "      <td>0.992971</td>\n",
       "      <td>1.017156</td>\n",
       "      <td>0.967130</td>\n",
       "      <td>1.008978</td>\n",
       "      <td>1.000526</td>\n",
       "      <td>0.991335</td>\n",
       "      <td>...</td>\n",
       "      <td>0.972738</td>\n",
       "      <td>0.999414</td>\n",
       "      <td>0.985540</td>\n",
       "      <td>0.979911</td>\n",
       "      <td>0.973503</td>\n",
       "      <td>0.928361</td>\n",
       "      <td>1.014178</td>\n",
       "      <td>0.937670</td>\n",
       "      <td>1.003783</td>\n",
       "      <td>0.990391</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2018-10-24</td>\n",
       "      <td>0.991514</td>\n",
       "      <td>1.002631</td>\n",
       "      <td>1.021842</td>\n",
       "      <td>1.003728</td>\n",
       "      <td>1.032429</td>\n",
       "      <td>0.988139</td>\n",
       "      <td>1.002256</td>\n",
       "      <td>1.104759</td>\n",
       "      <td>1.006119</td>\n",
       "      <td>...</td>\n",
       "      <td>1.002461</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.016216</td>\n",
       "      <td>1.047153</td>\n",
       "      <td>0.972006</td>\n",
       "      <td>1.026624</td>\n",
       "      <td>1.013196</td>\n",
       "      <td>1.003310</td>\n",
       "      <td>1.003769</td>\n",
       "      <td>1.007682</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2018-10-25</td>\n",
       "      <td>0.985704</td>\n",
       "      <td>1.002434</td>\n",
       "      <td>0.996576</td>\n",
       "      <td>0.988229</td>\n",
       "      <td>0.973011</td>\n",
       "      <td>1.009256</td>\n",
       "      <td>1.007391</td>\n",
       "      <td>0.935729</td>\n",
       "      <td>0.999305</td>\n",
       "      <td>...</td>\n",
       "      <td>1.008292</td>\n",
       "      <td>0.968942</td>\n",
       "      <td>0.997720</td>\n",
       "      <td>0.967370</td>\n",
       "      <td>0.974509</td>\n",
       "      <td>0.987805</td>\n",
       "      <td>0.964029</td>\n",
       "      <td>1.010859</td>\n",
       "      <td>0.974969</td>\n",
       "      <td>0.990235</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2018-10-26</td>\n",
       "      <td>1.013679</td>\n",
       "      <td>0.970912</td>\n",
       "      <td>0.991537</td>\n",
       "      <td>0.996140</td>\n",
       "      <td>1.004515</td>\n",
       "      <td>0.976647</td>\n",
       "      <td>0.977062</td>\n",
       "      <td>1.008118</td>\n",
       "      <td>0.976874</td>\n",
       "      <td>...</td>\n",
       "      <td>1.007621</td>\n",
       "      <td>1.019050</td>\n",
       "      <td>1.007616</td>\n",
       "      <td>0.995053</td>\n",
       "      <td>1.006012</td>\n",
       "      <td>0.985242</td>\n",
       "      <td>1.031656</td>\n",
       "      <td>0.995649</td>\n",
       "      <td>0.999037</td>\n",
       "      <td>0.990627</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2018-10-29</td>\n",
       "      <td>1.041056</td>\n",
       "      <td>1.039964</td>\n",
       "      <td>0.996567</td>\n",
       "      <td>0.982205</td>\n",
       "      <td>0.997826</td>\n",
       "      <td>1.017598</td>\n",
       "      <td>0.982306</td>\n",
       "      <td>0.987078</td>\n",
       "      <td>1.009256</td>\n",
       "      <td>...</td>\n",
       "      <td>1.024067</td>\n",
       "      <td>1.040653</td>\n",
       "      <td>1.071806</td>\n",
       "      <td>1.013107</td>\n",
       "      <td>1.042456</td>\n",
       "      <td>1.021255</td>\n",
       "      <td>1.054641</td>\n",
       "      <td>1.000410</td>\n",
       "      <td>1.049791</td>\n",
       "      <td>1.022019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>486</th>\n",
       "      <td>2020-10-14</td>\n",
       "      <td>1.002982</td>\n",
       "      <td>0.998241</td>\n",
       "      <td>1.009330</td>\n",
       "      <td>1.010889</td>\n",
       "      <td>1.018756</td>\n",
       "      <td>0.982035</td>\n",
       "      <td>1.006246</td>\n",
       "      <td>0.995064</td>\n",
       "      <td>0.986189</td>\n",
       "      <td>...</td>\n",
       "      <td>0.999456</td>\n",
       "      <td>0.974646</td>\n",
       "      <td>1.010772</td>\n",
       "      <td>1.005483</td>\n",
       "      <td>0.987946</td>\n",
       "      <td>0.994405</td>\n",
       "      <td>1.017020</td>\n",
       "      <td>0.993611</td>\n",
       "      <td>0.992922</td>\n",
       "      <td>1.003063</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>487</th>\n",
       "      <td>2020-10-15</td>\n",
       "      <td>0.964590</td>\n",
       "      <td>0.975441</td>\n",
       "      <td>0.997405</td>\n",
       "      <td>0.965126</td>\n",
       "      <td>0.983509</td>\n",
       "      <td>0.974714</td>\n",
       "      <td>0.967636</td>\n",
       "      <td>0.966001</td>\n",
       "      <td>0.983611</td>\n",
       "      <td>...</td>\n",
       "      <td>0.995091</td>\n",
       "      <td>0.971308</td>\n",
       "      <td>0.984014</td>\n",
       "      <td>0.996843</td>\n",
       "      <td>0.982588</td>\n",
       "      <td>0.982684</td>\n",
       "      <td>0.962913</td>\n",
       "      <td>1.004427</td>\n",
       "      <td>0.977936</td>\n",
       "      <td>0.975716</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>488</th>\n",
       "      <td>2020-10-16</td>\n",
       "      <td>0.986087</td>\n",
       "      <td>1.008283</td>\n",
       "      <td>0.999071</td>\n",
       "      <td>1.025743</td>\n",
       "      <td>1.007447</td>\n",
       "      <td>1.017370</td>\n",
       "      <td>1.020618</td>\n",
       "      <td>1.006137</td>\n",
       "      <td>1.003938</td>\n",
       "      <td>...</td>\n",
       "      <td>0.991733</td>\n",
       "      <td>1.006302</td>\n",
       "      <td>0.990975</td>\n",
       "      <td>1.035416</td>\n",
       "      <td>0.999506</td>\n",
       "      <td>0.999519</td>\n",
       "      <td>1.031883</td>\n",
       "      <td>1.053416</td>\n",
       "      <td>1.007810</td>\n",
       "      <td>1.007029</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>489</th>\n",
       "      <td>2020-10-19</td>\n",
       "      <td>1.000184</td>\n",
       "      <td>0.981272</td>\n",
       "      <td>1.012671</td>\n",
       "      <td>1.003502</td>\n",
       "      <td>1.035581</td>\n",
       "      <td>0.998581</td>\n",
       "      <td>1.030040</td>\n",
       "      <td>0.990166</td>\n",
       "      <td>1.015389</td>\n",
       "      <td>...</td>\n",
       "      <td>0.996871</td>\n",
       "      <td>1.003914</td>\n",
       "      <td>1.018215</td>\n",
       "      <td>1.016129</td>\n",
       "      <td>1.000626</td>\n",
       "      <td>1.014811</td>\n",
       "      <td>1.025361</td>\n",
       "      <td>0.980873</td>\n",
       "      <td>0.995695</td>\n",
       "      <td>1.009403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>490</th>\n",
       "      <td>2020-10-20</td>\n",
       "      <td>0.990672</td>\n",
       "      <td>1.010123</td>\n",
       "      <td>0.997842</td>\n",
       "      <td>1.016950</td>\n",
       "      <td>0.992026</td>\n",
       "      <td>1.010303</td>\n",
       "      <td>0.994262</td>\n",
       "      <td>1.018356</td>\n",
       "      <td>0.995245</td>\n",
       "      <td>...</td>\n",
       "      <td>0.989523</td>\n",
       "      <td>1.010916</td>\n",
       "      <td>0.978533</td>\n",
       "      <td>0.989600</td>\n",
       "      <td>1.013108</td>\n",
       "      <td>1.005302</td>\n",
       "      <td>0.995393</td>\n",
       "      <td>0.988523</td>\n",
       "      <td>1.001902</td>\n",
       "      <td>1.002000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>489 rows Ã— 101 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          Date  RELIANCE.NS    TCS.NS  HINDUNILVR.NS  HDFCBANK.NS   HDFC.NS  \\\n",
       "1   2018-10-23     0.992519  0.970853       0.979273     0.992971  1.017156   \n",
       "2   2018-10-24     0.991514  1.002631       1.021842     1.003728  1.032429   \n",
       "3   2018-10-25     0.985704  1.002434       0.996576     0.988229  0.973011   \n",
       "4   2018-10-26     1.013679  0.970912       0.991537     0.996140  1.004515   \n",
       "5   2018-10-29     1.041056  1.039964       0.996567     0.982205  0.997826   \n",
       "..         ...          ...       ...            ...          ...       ...   \n",
       "486 2020-10-14     1.002982  0.998241       1.009330     1.010889  1.018756   \n",
       "487 2020-10-15     0.964590  0.975441       0.997405     0.965126  0.983509   \n",
       "488 2020-10-16     0.986087  1.008283       0.999071     1.025743  1.007447   \n",
       "489 2020-10-19     1.000184  0.981272       1.012671     1.003502  1.035581   \n",
       "490 2020-10-20     0.990672  1.010123       0.997842     1.016950  0.992026   \n",
       "\n",
       "      INFY.NS  KOTAKBANK.NS  BHARTIARTL.NS    ITC.NS  ...  HONAUT.NS  \\\n",
       "1    0.967130      1.008978       1.000526  0.991335  ...   0.972738   \n",
       "2    0.988139      1.002256       1.104759  1.006119  ...   1.002461   \n",
       "3    1.009256      1.007391       0.935729  0.999305  ...   1.008292   \n",
       "4    0.976647      0.977062       1.008118  0.976874  ...   1.007621   \n",
       "5    1.017598      0.982306       0.987078  1.009256  ...   1.024067   \n",
       "..        ...           ...            ...       ...  ...        ...   \n",
       "486  0.982035      1.006246       0.995064  0.986189  ...   0.999456   \n",
       "487  0.974714      0.967636       0.966001  0.983611  ...   0.995091   \n",
       "488  1.017370      1.020618       1.006137  1.003938  ...   0.991733   \n",
       "489  0.998581      1.030040       0.990166  1.015389  ...   0.996871   \n",
       "490  1.010303      0.994262       1.018356  0.995245  ...   0.989523   \n",
       "\n",
       "     TATAMOTORS.NS    PNB.NS  HINDALCO.NS  GLAXO.NS  3MINDIA.NS    PEL.NS  \\\n",
       "1         0.999414  0.985540     0.979911  0.973503    0.928361  1.014178   \n",
       "2         1.000000  1.016216     1.047153  0.972006    1.026624  1.013196   \n",
       "3         0.968942  0.997720     0.967370  0.974509    0.987805  0.964029   \n",
       "4         1.019050  1.007616     0.995053  1.006012    0.985242  1.031656   \n",
       "5         1.040653  1.071806     1.013107  1.042456    1.021255  1.054641   \n",
       "..             ...       ...          ...       ...         ...       ...   \n",
       "486       0.974646  1.010772     1.005483  0.987946    0.994405  1.017020   \n",
       "487       0.971308  0.984014     0.996843  0.982588    0.982684  0.962913   \n",
       "488       1.006302  0.990975     1.035416  0.999506    0.999519  1.031883   \n",
       "489       1.003914  1.018215     1.016129  1.000626    1.014811  1.025361   \n",
       "490       1.010916  0.978533     0.989600  1.013108    1.005302  0.995393   \n",
       "\n",
       "     KANSAINER.NS  ADANITRANS.NS     NIFTY  \n",
       "1        0.937670       1.003783  0.990391  \n",
       "2        1.003310       1.003769  1.007682  \n",
       "3        1.010859       0.974969  0.990235  \n",
       "4        0.995649       0.999037  0.990627  \n",
       "5        1.000410       1.049791  1.022019  \n",
       "..            ...            ...       ...  \n",
       "486      0.993611       0.992922  1.003063  \n",
       "487      1.004427       0.977936  0.975716  \n",
       "488      1.053416       1.007810  1.007029  \n",
       "489      0.980873       0.995695  1.009403  \n",
       "490      0.988523       1.001902  1.002000  \n",
       "\n",
       "[489 rows x 101 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LinearRegression\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Date', 'RELIANCE.NS', 'TCS.NS', 'HINDUNILVR.NS', 'HDFCBANK.NS',\n",
       "       'HDFC.NS', 'INFY.NS', 'KOTAKBANK.NS', 'BHARTIARTL.NS', 'ITC.NS',\n",
       "       ...\n",
       "       'HONAUT.NS', 'TATAMOTORS.NS', 'PNB.NS', 'HINDALCO.NS', 'GLAXO.NS',\n",
       "       '3MINDIA.NS', 'PEL.NS', 'KANSAINER.NS', 'ADANITRANS.NS', 'NIFTY'],\n",
       "      dtype='object', length=101)"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in x.columns:\n",
    "    if(i!=\"Date\"):\n",
    "        x[i]=x[i]-1\n",
    "        \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([-2.93921492e-03,  1.70243910e-02,  1.20501553e-03, -2.31923246e-02,\n",
       "        1.53845903e-02, -7.51012513e-03,  2.30314053e-02, -2.26060645e-04,\n",
       "       -2.55230774e-03, -9.26342783e-03, -3.62891231e-03,  9.22014483e-03,\n",
       "        2.80251947e-02, -3.07716679e-02,  1.01151019e-03, -3.58583473e-04,\n",
       "       -4.23909964e-03, -3.47110403e-03, -9.85842144e-03, -2.30991201e-02,\n",
       "        5.50365380e-03, -2.43943697e-02, -2.22337228e-02, -1.85244690e-02,\n",
       "        2.95200785e-02,  1.54934673e-02,  6.42046849e-03, -1.65660808e-02,\n",
       "        1.36019514e-03,  1.19462035e-02,  1.20805549e-02,  2.61849500e-03,\n",
       "        9.12388283e-03, -6.28523646e-03, -7.33978398e-03,  2.48058341e-02,\n",
       "       -1.18699945e-02, -2.75918118e-02, -1.97584109e-02, -1.72267656e-02,\n",
       "       -4.13076520e-03, -4.15509402e-02, -9.40805094e-03,  2.02864237e-02,\n",
       "       -2.34573259e-03, -2.13107686e-02, -3.06219343e-02, -1.23406802e-01,\n",
       "        3.53633476e-02, -7.84968387e-02,  3.97931144e-02, -8.10640183e-02,\n",
       "       -7.58098599e-03, -3.91865021e-02, -5.24522622e-02,  1.09240507e-01,\n",
       "       -1.31538934e-01,  6.71342913e-02,  1.47180380e-01, -1.48302425e-02,\n",
       "       -5.62767672e-04, -3.29861534e-02,  8.08386053e-02, -2.98990837e-02,\n",
       "       -2.77661348e-03,  1.19402369e-01, -1.15662142e-02,  2.33191429e-02,\n",
       "       -2.52468627e-02, -3.30488911e-02,  1.58282943e-02,  4.79002550e-02,\n",
       "        1.61764869e-02, -5.18574648e-03,  1.02032559e-01,  5.35348569e-03,\n",
       "        3.36275904e-02,  8.99785821e-03, -1.11906230e-03, -8.40279899e-04,\n",
       "        1.77161024e-02, -2.10090730e-02,  1.77321492e-02,  6.90156781e-05,\n",
       "        3.16303697e-02,  3.63946565e-02,  9.60490162e-03, -6.18634077e-02,\n",
       "        2.12165838e-02, -4.04290162e-02,  1.63306710e-02, -1.27792011e-02,\n",
       "       -2.21065269e-02,  1.76023309e-02,  5.26616035e-03, -6.73025603e-03,\n",
       "       -5.23906206e-03,  1.50977713e-02,  1.84704612e-02, -5.33200461e-03,\n",
       "        3.82067875e-02,  1.00962942e-02,  3.87452943e-03,  2.47462358e-02,\n",
       "        1.20263920e-03, -7.71325581e-03, -2.06115941e-02,  2.27693749e-02,\n",
       "       -2.19126911e-02,  3.32315090e-02,  1.62072073e-02,  1.95091158e-03,\n",
       "       -1.45266577e-03,  2.51029985e-02,  6.25037506e-02, -7.53097916e-03,\n",
       "       -1.44603683e-02,  4.03855441e-03, -5.75856722e-03,  1.38250048e-02,\n",
       "       -1.06221057e-02, -1.10553471e-02,  1.96584412e-02])"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x[288:411].tail()\n",
    "omk=x[288:411][\"RELIANCE.NS\"]\n",
    "omkay=x[288:411][\"NIFTY\"]\n",
    "omk=np.array(omk)\n",
    "omkay=np.array(omkay)\n",
    "omkay=omkay.reshape(-1,1)\n",
    "omk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "mod1=LinearRegression().fit(omkay,omk)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.132860371094961"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mod1.coef_[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "def Beta_Cal(st, end):\n",
    "    Beta=pd.DataFrame({'Name':[],'col':[]})\n",
    "    ind =0\n",
    "    nif=x[st:end][\"NIFTY\"]\n",
    "    nif=np.array(nif)\n",
    "    nif=nif.reshape(-1,1)\n",
    "    for i in x.columns:\n",
    "        if(i!=\"Date\"):\n",
    "            z=x[st:end][i]\n",
    "            z=np.array(z)\n",
    "            mod=LinearRegression().fit(nif,z)\n",
    "            Beta=Beta.append({'Name':i,\"col\":mod.coef_[0]},ignore_index=True)\n",
    "    return Beta\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Date             2020-05-29 00:00:00\n",
       "RELIANCE.NS                -0.005332\n",
       "TCS.NS                    -0.0159408\n",
       "HINDUNILVR.NS              0.0235828\n",
       "HDFCBANK.NS               0.00677072\n",
       "                        ...         \n",
       "3MINDIA.NS                 0.0158151\n",
       "PEL.NS                     0.0103362\n",
       "KANSAINER.NS               0.0112641\n",
       "ADANITRANS.NS             -0.0450303\n",
       "NIFTY                     0.00950466\n",
       "Name: 389, Length: 101, dtype: object"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.loc[389]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Int64Index([390], dtype='int64')"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x[x['Date']=='2020-06-01'].index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "B19_12=Beta_Cal(149,268)\n",
    "B19_12=B19_12.rename(columns={'col':'Dec19'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "B20_1=Beta_Cal(168,289)\n",
    "B20_1=B20_1.rename(columns={'col':'Jan20'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "B20_2=Beta_Cal(191,312)\n",
    "B20_2=B20_2.rename(columns={'col':'Feb20'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "B20_3=Beta_Cal(211,331)\n",
    "B20_3=B20_3.rename(columns={'col':'Mar20'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "B20_4=Beta_Cal(230,352)\n",
    "B20_4=B20_4.rename(columns={'col':'Apr20'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "B20_5=Beta_Cal(269,370)\n",
    "B20_5=B20_5.rename(columns={'col':'May20'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "B20_6=Beta_Cal(290,389)\n",
    "B20_6=B20_6.rename(columns={'col':'Jun20'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Name</th>\n",
       "      <th>Dec19</th>\n",
       "      <th>Jan20</th>\n",
       "      <th>Feb20</th>\n",
       "      <th>Mar20</th>\n",
       "      <th>Apr20</th>\n",
       "      <th>May20</th>\n",
       "      <th>Jun20</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>RELIANCE.NS</td>\n",
       "      <td>0.754671</td>\n",
       "      <td>0.710306</td>\n",
       "      <td>0.824602</td>\n",
       "      <td>1.029171</td>\n",
       "      <td>1.214542</td>\n",
       "      <td>1.170049</td>\n",
       "      <td>1.144818</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>TCS.NS</td>\n",
       "      <td>0.072105</td>\n",
       "      <td>0.082450</td>\n",
       "      <td>0.023838</td>\n",
       "      <td>0.187825</td>\n",
       "      <td>0.732584</td>\n",
       "      <td>0.808782</td>\n",
       "      <td>0.772621</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>HINDUNILVR.NS</td>\n",
       "      <td>0.788280</td>\n",
       "      <td>0.800346</td>\n",
       "      <td>0.605432</td>\n",
       "      <td>0.686877</td>\n",
       "      <td>0.695299</td>\n",
       "      <td>0.687651</td>\n",
       "      <td>0.673547</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>HDFCBANK.NS</td>\n",
       "      <td>1.133351</td>\n",
       "      <td>1.140149</td>\n",
       "      <td>1.181790</td>\n",
       "      <td>1.058876</td>\n",
       "      <td>0.968645</td>\n",
       "      <td>1.010984</td>\n",
       "      <td>1.058032</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>HDFC.NS</td>\n",
       "      <td>1.058028</td>\n",
       "      <td>1.064193</td>\n",
       "      <td>1.200209</td>\n",
       "      <td>1.155059</td>\n",
       "      <td>1.233529</td>\n",
       "      <td>1.225365</td>\n",
       "      <td>1.263933</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>3MINDIA.NS</td>\n",
       "      <td>0.850544</td>\n",
       "      <td>0.905911</td>\n",
       "      <td>0.836813</td>\n",
       "      <td>0.733496</td>\n",
       "      <td>0.751654</td>\n",
       "      <td>0.700970</td>\n",
       "      <td>0.708073</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>PEL.NS</td>\n",
       "      <td>1.324171</td>\n",
       "      <td>1.259867</td>\n",
       "      <td>1.432919</td>\n",
       "      <td>1.460153</td>\n",
       "      <td>1.079963</td>\n",
       "      <td>0.960299</td>\n",
       "      <td>0.994843</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>KANSAINER.NS</td>\n",
       "      <td>0.922238</td>\n",
       "      <td>0.868821</td>\n",
       "      <td>0.861132</td>\n",
       "      <td>0.729688</td>\n",
       "      <td>0.774966</td>\n",
       "      <td>0.707329</td>\n",
       "      <td>0.736807</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>ADANITRANS.NS</td>\n",
       "      <td>0.597714</td>\n",
       "      <td>0.632661</td>\n",
       "      <td>0.666776</td>\n",
       "      <td>0.785822</td>\n",
       "      <td>0.619343</td>\n",
       "      <td>0.582529</td>\n",
       "      <td>0.584567</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>NIFTY</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows Ã— 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             Name     Dec19     Jan20     Feb20     Mar20     Apr20     May20  \\\n",
       "0     RELIANCE.NS  0.754671  0.710306  0.824602  1.029171  1.214542  1.170049   \n",
       "1          TCS.NS  0.072105  0.082450  0.023838  0.187825  0.732584  0.808782   \n",
       "2   HINDUNILVR.NS  0.788280  0.800346  0.605432  0.686877  0.695299  0.687651   \n",
       "3     HDFCBANK.NS  1.133351  1.140149  1.181790  1.058876  0.968645  1.010984   \n",
       "4         HDFC.NS  1.058028  1.064193  1.200209  1.155059  1.233529  1.225365   \n",
       "..            ...       ...       ...       ...       ...       ...       ...   \n",
       "95     3MINDIA.NS  0.850544  0.905911  0.836813  0.733496  0.751654  0.700970   \n",
       "96         PEL.NS  1.324171  1.259867  1.432919  1.460153  1.079963  0.960299   \n",
       "97   KANSAINER.NS  0.922238  0.868821  0.861132  0.729688  0.774966  0.707329   \n",
       "98  ADANITRANS.NS  0.597714  0.632661  0.666776  0.785822  0.619343  0.582529   \n",
       "99          NIFTY  1.000000  1.000000  1.000000  1.000000  1.000000  1.000000   \n",
       "\n",
       "       Jun20  \n",
       "0   1.144818  \n",
       "1   0.772621  \n",
       "2   0.673547  \n",
       "3   1.058032  \n",
       "4   1.263933  \n",
       "..       ...  \n",
       "95  0.708073  \n",
       "96  0.994843  \n",
       "97  0.736807  \n",
       "98  0.584567  \n",
       "99  1.000000  \n",
       "\n",
       "[100 rows x 8 columns]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "B20=B19_12.join(B20_1.set_index('Name'), on='Name')\n",
    "B20=B20.join(B20_2.set_index('Name'), on='Name')\n",
    "B20=B20.join(B20_3.set_index('Name'), on='Name')\n",
    "B20=B20.join(B20_4.set_index('Name'), on='Name')\n",
    "B20=B20.join(B20_5.set_index('Name'), on='Name')\n",
    "B20=B20.join(B20_6.set_index('Name'), on='Name')\n",
    "B20"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "B20.to_excel('Beta_1.xlsx')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 200,
   "metadata": {},
   "outputs": [],
   "source": [
    "#df={'2020':B20, '2019': B19}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 202,
   "metadata": {},
   "outputs": [],
   "source": [
    "'''''writer=pd.ExcelWriter('Beta_new.xlsx', engine='xlsxwriter')\n",
    "\n",
    "for sheets in df.keys():\n",
    "    df[sheets].to_excel(writer, sheet_name=sheets)\n",
    "writer.save()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (<ipython-input-25-f188d5ac1197>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"<ipython-input-25-f188d5ac1197>\"\u001b[1;36m, line \u001b[1;32m1\u001b[0m\n\u001b[1;33m    git init\u001b[0m\n\u001b[1;37m           ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
